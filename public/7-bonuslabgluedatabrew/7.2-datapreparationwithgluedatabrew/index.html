<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.133.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Data preparation with Glue DataBrew :: Getting Hands On with Amazon GuardDuty</title>

    
    <link href="/css/nucleus.css?1733820671" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1733820671" rel="stylesheet">
    <link href="/css/hybrid.css?1733820671" rel="stylesheet">
    <link href="/css/featherlight.min.css?1733820671" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1733820671" rel="stylesheet">
    <link href="/css/auto-complete.css?1733820671" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1733820671" rel="stylesheet">
    <link href="/css/theme.css?1733820671" rel="stylesheet">
    <link href="/css/hugo-theme.css?1733820671" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1733820671" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1733820671"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/7-bonuslabgluedatabrew/7.2-datapreparationwithgluedatabrew/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1733820671"></script>
<script type="text/javascript" src="/js/auto-complete.js?1733820671"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1733820671"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduce/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/1-introduce/">
           <b> 1. </b> Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-lab1/" title="Lab. Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/">
           <b> 2 </b> Lab. Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.1-prepare/" title="Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.1-prepare/">
           <b> 2.1 </b> Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.2-lab/" title="Lab" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.2-lab/">
           <b> 2.2 </b> Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.3-labetl/" title="Lab. Streaming ETL with Glue " class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.3-labetl/">
           <b> 2.3 </b> Lab. Streaming ETL with Glue 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.4-kinesis/" title="Real-time Streaming with Kinesis" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.4-kinesis/">
           <b> 2.4 </b> Real-time Streaming with Kinesis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.5-msk/" title="Clickstream Analytics using MSK" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.5-msk/">
           <b> 2.5 </b> Clickstream Analytics using MSK
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-ingestionwithdms/" title="Nhập data với DMS" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/">
           <b> 3. </b> Nhập data với DMS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-ingestionwithdms/3.1-dms-migration-lab/" title=" Option1: DMS Migration Lab" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/3.1-dms-migration-lab/">
           <b> 3.1. </b>  Option1: DMS Migration Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-ingestionwithdms/3.3-skip-dms-lab/" title="Option 2: AutoComplete DMS Lab" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/3.3-skip-dms-lab/">
           <b> 3.2. </b> Option 2: AutoComplete DMS Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-ingestionwithdms/3.2-private-instance/" title="Option 3: Skip DMS Lab" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/3.2-private-instance/">
           <b> 3.2. </b> Option 3: Skip DMS Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/" title="Lab: Transforming data with Glue" class="dd-item 
        
        
        
        ">
      <a href="/4-transformingdatawithglue/">
           <b> 4. </b> Lab: Transforming data with Glue
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/4.1-datavalidationandetl/" title="Data Validation and ETL" class="dd-item 
        
        
        
        ">
      <a href="/4-transformingdatawithglue/4.1-datavalidationandetl/">
           <b> 4.1 </b> Data Validation and ETL
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/4.2-hudi/" title="Incremental Data Processing with Hudi" class="dd-item 
        
        
        
        ">
      <a href="/4-transformingdatawithglue/4.2-hudi/">
           <b> 4.2 </b> Incremental Data Processing with Hudi
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/" title="Lab: Query and Visualize" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/">
           <b> 5. </b> Lab: Query and Visualize
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/5.1-athenaandquicksight/" title="Athena and QuickSight" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/5.1-athenaandquicksight/">
           <b> 5.1 </b> Athena and QuickSight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/5.2-athenafederatedquery/" title="Athena Federated query" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/5.2-athenafederatedquery/">
           <b> 5.2 </b> Athena Federated query
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/5.3-athenaandsagemaker/" title="Athena and SageMaker" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/5.3-athenaandsagemaker/">
           <b> 5.3 </b> Athena and SageMaker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/" title="Lab: Data Lake Automation" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/">
          <b>6. </b>Lab: Data Lake Automation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.1-lakeformationlab/" title="Lake Formation Lab" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.1-lakeformationlab/">
           <b> 6.1 </b> Lake Formation Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.2-lakeformationlabforapachehuditables/" title="Lake Formation Lab for Apache Hudi Tables" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.2-lakeformationlabforapachehuditables/">
           <b> 6.2 </b> Lake Formation Lab for Apache Hudi Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.3-lakeformationlabforapacheicebergtables/" title="Lake Formation Lab for Apache Iceberg Tables" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.3-lakeformationlabforapacheicebergtables/">
           <b> 6.3 </b> Lake Formation Lab for Apache Iceberg Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.4-lakeformationlabordeltatables/" title="Lake Formation Lab for Delta Tables" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.4-lakeformationlabordeltatables/">
           <b> 6.4 </b> Lake Formation Lab for Delta Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-bonuslabgluedatabrew/" title="Bonus Lab: Glue DataBrew" class="dd-item 
        parent
        
        
        ">
      <a href="/7-bonuslabgluedatabrew/">
          <b>7. </b>Bonus Lab: Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/7-bonuslabgluedatabrew/7.1-databrewpre-lab/" title="DataBrew Pre-Lab" class="dd-item 
        
        
        
        ">
      <a href="/7-bonuslabgluedatabrew/7.1-databrewpre-lab/">
           <b> 7.1 </b> DataBrew Pre-Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/7-bonuslabgluedatabrew/7.2-datapreparationwithgluedatabrew/" title="Data preparation with Glue DataBrew" class="dd-item 
        
        active
        
        ">
      <a href="/7-bonuslabgluedatabrew/7.2-datapreparationwithgluedatabrew/">
           <b> 7.2 </b> Data preparation with Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/8-clean/" title="Clean up" class="dd-item 
        
        
        
        ">
      <a href="/8-clean/">
          <b>8. </b>Clean up
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/660548818043427/"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/7-bonuslabgluedatabrew/7.2-datapreparationwithgluedatabrew/" selected>English</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>10-12-2024</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
            <i> <a href="https://www.linkedin.com/in/nguy%E1%BB%85n-xu%C3%A2n-d%C6%B0%C6%A1ng-132936285/"  style="color:orange">Dương Nguyễn Xuân  </a> <br>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Data Engineering Immersion Day</a> > <a href='/7-bonuslabgluedatabrew/'>Bonus Lab: Glue DataBrew</a> > Data preparation with Glue DataBrew
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#các-công-việc-hoàn-thành-trong-bài-lab-này">Các công việc hoàn thành trong bài lab này</a></li>
        <li><a href="#tạo-project">Tạo project</a></li>
        <li><a href="#khám-phá-dataset">Khám phá dataset</a></li>
        <li><a href="#chuẩn-bị-tập-dữ-liệu">Chuẩn bị tập dữ liệu</a></li>
        <li><a href="#tạo-databrew-job">Tạo DataBrew Job</a></li>
        <li><a href="#xem-dòng-dữ-liệu">Xem dòng dữ liệu</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Data preparation with Glue DataBrew
            </h1>
          

        



	<h3 id="các-công-việc-hoàn-thành-trong-bài-lab-này">Các công việc hoàn thành trong bài lab này</h3>
<ul>
<li>Tạo Glue DataBrew để khám phá dữ liệu</li>
<li>Kết nối với S3 sample dataset</li>
<li>Khám phá dataset trong Glue DataBrew</li>
<li>Tạo rich data profile trong dataset</li>
<li>Dọn dẹp và chuẩn hóa dữ liệu</li>
</ul>
<h3 id="tạo-project">Tạo project</h3>
<ol>
<li>
<p>Truy cập AWS Glue DataBrew và nhấn <strong>Create project</strong></p>
</li>
<li>
<p>Tạo project với các thông tin:
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/2.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/3.png"></p>
</li>
<li>
<p>Tại phần <strong>Connect to a new dataset</strong>, chọn <strong>Amazon S3</strong> bên dưới &ldquo;Data lake/data store&rdquo;
Nhập <strong>DatasetS3Path</strong> từ output cloudformation
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/5.png"></p>
</li>
<li>
<p>Trong phần <strong>Sampling</strong> dể mặc định.
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/6.png"></p>
</li>
<li>
<p>Trong phần <strong>Permissions</strong> chọn role name từ <strong>OutPut</strong> cloudformation có key là: <strong>DataBrewLabRole</strong>
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/7.png"></p>
</li>
<li>
<p>Nhấn <strong>Create project</strong>
Glue DataBrew sẽ tạo project trong vòng vài phút.
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/8.png"></p>
</li>
</ol>
<h3 id="khám-phá-dataset">Khám phá dataset</h3>
<ol>
<li>Ghi project đã được tạo, chúng ta sẽ thấy <strong>Grid</strong> view như sau. Đây là view mặc định, dữ liệu được hiển thị dưới dạng bảng
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/9.png"></li>
</ol>
<p>Grid view hiển thị các thông tin sau:</p>
<ul>
<li>Các cột trong dataset</li>
<li>Kiểu dữ liệu của các cột</li>
<li>Phạm vi của các giá trị tìm thấy</li>
<li>Phân phối thống kê các cột dữ liệu số</li>
</ul>
<ol start="2">
<li>Chọn Schema Tab
Schema view hiển thị lược đồ đã được suy ra từ tập dữ liệu. Trong Schema view, bạn có thể xem số liệu thống kê về các giá trị dữ liệu trong mỗi cột.</li>
</ol>
<p>Trong schema view, chúng ta có thể:</p>
<ul>
<li>Chọn checkbox  để xem tóm tắt thống kê cho các giá trị cột</li>
<li>Hiển thị/Ẩn cột</li>
<li>Đổi tên cột</li>
<li>Thay đổi kiểu dữ liệu của cột</li>
<li>Sắp xếp lại thứ tự cột bằng cách kéo thả các cột</li>
</ul>
<ol start="3">
<li>Click vào <strong>Profile</strong> tab</li>
</ol>
<p>Trong profile view, chúng ta có thể chạy data profile job để kiểm tra và thu thập các tóm tắt thống kê về dữ liệu. Data profile là sự đánh giá về mặt cấu trúc, nội dung, mối quan hệ và nguồn gốc.
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/10.png"></p>
<p>Chọn <strong>Run data profile</strong>
Trong <strong>Job details</strong> và <strong>Job run sample</strong> để các value bằng mặc định. Trong <strong>Job output settings</strong> chọn value của key <strong>DataBrewOutputS3Bucket</strong> và thêm vào cuối /data-profile/ như sau:
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/11.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/12.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/13.png"></p>
<p>Cuối cùng nhấn <strong>Create and run job</strong></p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/142.png"></p>
<ol start="4">
<li>Chọn Jobs và click vào <strong>Profile jobs</strong>  tab để xem danh sách profile job.</li>
</ol>
<p>Khi profile job successfully completed, chọn <strong>View data profile</strong></p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/14.png"></p>
<p>Sau đó, sẽ hiển thị ra <strong>Data profile overview</strong></p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/15.png"></p>
<p>Bạn cũng có thể truy cập Profile tab trong project
Data profile hiển thị bản tóm tắt về các hàng và cột trong tập dữ liệu, số lượng cột và hàng hợp lệ cũng như mối tương quan giữa các cột.</p>
<ol start="5">
<li>Chọn <strong>Column statistics</strong> tab để xem bảng phân tích từng cột của các giá trị dữ liệu.
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/16.png"></li>
</ol>
<h3 id="chuẩn-bị-tập-dữ-liệu">Chuẩn bị tập dữ liệu</h3>
<p>Trong phần này, chúng ta sẽ áp dụng các phép biến đổi sau cho tập dữ liệu.</p>
<ul>
<li>Chuyển đổi cột ngày từ integer thành string</li>
<li>Chia cột ngày thành 3 cột mới (năm, tháng, ngày) để phân chia dữ liệu theo các cột này</li>
<li>Điền các giá trị còn thiếu vào cột có thể xảy ra bằng 0</li>
<li>Ánh xạ các giá trị của cột dataQualityGrade thành một giá trị số</li>
</ul>
<ol>
<li>Quay trở lại project covid-states-daily và chọn <strong>PROJECTS</strong></li>
<li>DataBrew đã suy ra cột dữ liệu date là số nguyên. Chúng ta sẽ convert cột date thành string
Chọn # icon và chọn <strong>string</strong>
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/17.png"></li>
</ol>
<p>Chọn <strong>Apply</strong>
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/18.png"></p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/19.png"></p>
<ol start="3">
<li>Chúng ta sẽ copy cột date trước khi split date thành year, month, day.</li>
</ol>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/20.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/21.png"></p>
<p>Click apply.</p>
<ol start="4">
<li>Split cột date thành các cột year, month, day và đổi tên các cột tương ứng</li>
</ol>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/22.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/23.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/24.png"></p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/25.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/26.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/27.png"></p>
<ol start="5">
<li>
<p>Cột probableCases bị thiếu dữ liệu. Chúng ta sẽ điền vào các chỗ bị thiếu giá trị 0.
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/28.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/29.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/30.png"></p>
</li>
<li>
<p>Ánh xạ các giá trị của cột dataQualityGrade thành các giá trị số.</p>
</li>
</ol>
<p>Để điều hướng đến cột dataQualityGrade, hãy nhấp vào danh sách cột thả xuống ở trên cùng, nhập dataQualityGrade vào trường tìm kiếm và nhấp vào <strong>View</strong>.</p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/31.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/32.png"></p>
<p>Trong Categorically map column dialog</p>
<ul>
<li>Chọn <strong>Map all values</strong></li>
<li>Chọn <strong>Map values to numeric values</strong></li>
<li>Map dataQualityGrade value hiện tại thành new value
<table>
<thead>
<tr>
<th>dataQualityGrade</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>N/A</td>
<td>0</td>
</tr>
<tr>
<td>A+</td>
<td>1</td>
</tr>
<tr>
<td>A</td>
<td>2</td>
</tr>
<tr>
<td>B</td>
<td>3</td>
</tr>
<tr>
<td>C</td>
<td>4</td>
</tr>
<tr>
<td>D</td>
<td>5</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/33.png"></p>
<p>Để tất cả các cài đặt khác làm mặc định. Nhấp vào <strong>Apply</strong></p>
<p>Sau phép biến đổi này, cột mới dataQualityGrade_mapped có kiểu double, hãy chuyển cột này thành số nguyên. Bằng cách nhấp vào # ở trên cùng bên trái của cột mới dataQualityGrade_mapped. Nhấp vào <strong>Apply</strong> ở phía bên phải để xác nhận thay đổi.</p>
<ol start="7">
<li>Chúng ta đã sẵn sàng xuất bản recipe để sử dụng trong DataBrew jobs. Final recipe sẽ trông như thế này</li>
</ol>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/34.png"></p>
<p>Nhấp vào nút <strong>Publish</strong> ở đầu công thức.</p>
<p>Tùy chọn nhập mô tả phiên bản và nhấp vào <strong>Publish</strong>
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/553.png"></p>
<h3 id="tạo-databrew-job">Tạo DataBrew Job</h3>
<ol>
<li>Chọn <strong>Jobs</strong>
Mở <strong>Recipe jobs</strong> tab, và click vào <strong>Create job</strong></li>
</ol>
<p>Nhập covid-states-daily-prep là job name</p>
<p>Chọn <strong>Create a recipe job</strong></p>
<p>Chọn covid-states-daily-stats dataset</p>
<p>Chọn covid-states-daily-recipe</p>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/36.png"></p>
<p>Tại mục <strong>Job output settings</strong> nhập:</p>
<ul>
<li><strong>Output to</strong> Amazon S3.</li>
<li><strong>File type</strong>: CSV.</li>
<li><strong>Delimiter</strong> Comma(,).</li>
<li><strong>Compression</strong> None.</li>
<li><strong>S3 bucket owners&rsquo;s Account</strong> Current AWS account.</li>
<li><strong>S3 location</strong>: giá trị của key <strong>DataBrewOutputS3Bucket</strong> và thêm /job-outputs/ vào cuối. Ví du: s3://databrew-lab-databrewoutputs3bucket-xxxxx/job-outputs/.</li>
</ul>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/37.png"></p>
<p>Click <strong>Settings</strong></p>
<ul>
<li>Chọn <strong>Create a new folder for each job run.</strong></li>
<li><strong>Custom partition by column values</strong>: Enabled. Tiếp theo tìm kiếm và <strong>Add</strong> year, month và day ở phần <strong>Columns to partition by</strong>. Cuối cùng nhấn save</li>
</ul>
<p><img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/3838.png"></p>
<p>Tại Permissions chọn role từ Output của CloudFomation:
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/35.png"></p>
<p>Chọn <strong>Create and run job</strong></p>
<ol start="2">
<li>DataBrew job đã được tạo và running
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/39.png">
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/40.png"></li>
</ol>
<h3 id="xem-dòng-dữ-liệu">Xem dòng dữ liệu</h3>
<ol>
<li>Tại DataBrew, Truy cập covid-states-daily project.</li>
</ol>
<p>Chọn <strong>Lineage</strong>
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/45.png"></p>
<p>Chế độ xem này hiển thị nguồn gốc của dữ liệu và các bước chuyển đổi mà dữ liệu đã trải qua.
<img alt="Clean" src="/WorkShopTwo/images/7.DataBrewDataBrew/46.png"></p>
<p>Chúng ta đã hoàn thành DataBrew Lab.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/7-bonuslabgluedatabrew/7.1-databrewpre-lab/" title="DataBrew Pre-Lab"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/8-clean/" title="Clean up" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1733820671"></script>
    <script src="/js/perfect-scrollbar.min.js?1733820671"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1733820671"></script>
    <script src="/js/jquery.sticky.js?1733820671"></script>
    <script src="/js/featherlight.min.js?1733820671"></script>
    <script src="/js/highlight.pack.js?1733820671"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1733820671"></script>
    <script src="/js/learn.js?1733820671"></script>
    <script src="/js/hugo-learn.js?1733820671"></script>

    <link href="/mermaid/mermaid.css?1733820671" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1733820671"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
