<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.122.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lake Formation Lab for Apache Hudi Tables :: Getting Hands On with Amazon GuardDuty</title>

    
    <link href="/css/nucleus.css?1715586281" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1715586281" rel="stylesheet">
    <link href="/css/hybrid.css?1715586281" rel="stylesheet">
    <link href="/css/featherlight.min.css?1715586281" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1715586281" rel="stylesheet">
    <link href="/css/auto-complete.css?1715586281" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1715586281" rel="stylesheet">
    <link href="/css/theme.css?1715586281" rel="stylesheet">
    <link href="/css/hugo-theme.css?1715586281" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1715586281" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1715586281"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/6-labdatalakeautomation/6.2-lakeformationlabforapachehuditables/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1715586281"></script>
<script type="text/javascript" src="/js/auto-complete.js?1715586281"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1715586281"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduce/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/1-introduce/">
           <b> 1. </b> Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-lab1/" title="Lab. Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/">
           <b> 2 </b> Lab. Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.1-prepare/" title="Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.1-prepare/">
           <b> 2.1 </b> Phát hiện luồng click chuột bất thường bằng Amazon Managed Service for Apache Flink
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.2-lab/" title="Lab" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.2-lab/">
           <b> 2.2 </b> Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.3-labetl/" title="Lab. Streaming ETL with Glue " class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.3-labetl/">
           <b> 2.3 </b> Lab. Streaming ETL with Glue 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.4-kinesis/" title="Real-time Streaming with Kinesis" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.4-kinesis/">
           <b> 2.4 </b> Real-time Streaming with Kinesis
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-lab1/2.5-msk/" title="Clickstream Analytics using MSK" class="dd-item 
        
        
        
        ">
      <a href="/2-lab1/2.5-msk/">
           <b> 2.5 </b> Clickstream Analytics using MSK
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-ingestionwithdms/" title="Nhập data với DMS" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/">
           <b> 3. </b> Nhập data với DMS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-ingestionwithdms/3.1-dms-migration-lab/" title=" Option1: DMS Migration Lab" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/3.1-dms-migration-lab/">
           <b> 3.1. </b>  Option1: DMS Migration Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-ingestionwithdms/3.3-skip-dms-lab/" title="Option 2: AutoComplete DMS Lab" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/3.3-skip-dms-lab/">
           <b> 3.2. </b> Option 2: AutoComplete DMS Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-ingestionwithdms/3.2-private-instance/" title="Option 3: Skip DMS Lab" class="dd-item 
        
        
        
        ">
      <a href="/3-ingestionwithdms/3.2-private-instance/">
           <b> 3.2. </b> Option 3: Skip DMS Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/" title="Lab: Transforming data with Glue" class="dd-item 
        
        
        
        ">
      <a href="/4-transformingdatawithglue/">
           <b> 4. </b> Lab: Transforming data with Glue
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/4.1-datavalidationandetl/" title="Data Validation and ETL" class="dd-item 
        
        
        
        ">
      <a href="/4-transformingdatawithglue/4.1-datavalidationandetl/">
           <b> 4.1 </b> Data Validation and ETL
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-transformingdatawithglue/4.2-hudi/" title="Incremental Data Processing with Hudi" class="dd-item 
        
        
        
        ">
      <a href="/4-transformingdatawithglue/4.2-hudi/">
           <b> 4.2 </b> Incremental Data Processing with Hudi
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/" title="Lab: Query and Visualize" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/">
           <b> 5. </b> Lab: Query and Visualize
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/5.1-athenaandquicksight/" title="Athena and QuickSight" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/5.1-athenaandquicksight/">
           <b> 5.1 </b> Athena and QuickSight
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/5.2-athenafederatedquery/" title="Athena Federated query" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/5.2-athenafederatedquery/">
           <b> 5.2 </b> Athena Federated query
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5-labqueryandvisualize/5.3-athenaandsagemaker/" title="Athena and SageMaker" class="dd-item 
        
        
        
        ">
      <a href="/5-labqueryandvisualize/5.3-athenaandsagemaker/">
           <b> 5.3 </b> Athena and SageMaker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/" title="Lab: Data Lake Automation" class="dd-item 
        parent
        
        
        ">
      <a href="/6-labdatalakeautomation/">
          <b>6. </b>Lab: Data Lake Automation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.1-lakeformationlab/" title="Lake Formation Lab" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.1-lakeformationlab/">
           <b> 6.1 </b> Lake Formation Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.2-lakeformationlabforapachehuditables/" title="Lake Formation Lab for Apache Hudi Tables" class="dd-item 
        
        active
        
        ">
      <a href="/6-labdatalakeautomation/6.2-lakeformationlabforapachehuditables/">
           <b> 6.2 </b> Lake Formation Lab for Apache Hudi Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.3-lakeformationlabforapacheicebergtables/" title="Lake Formation Lab for Apache Iceberg Tables" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.3-lakeformationlabforapacheicebergtables/">
           <b> 6.3 </b> Lake Formation Lab for Apache Iceberg Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-labdatalakeautomation/6.4-lakeformationlabordeltatables/" title="Lake Formation Lab for Delta Tables" class="dd-item 
        
        
        
        ">
      <a href="/6-labdatalakeautomation/6.4-lakeformationlabordeltatables/">
           <b> 6.4 </b> Lake Formation Lab for Delta Tables
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-bonuslabgluedatabrew/" title="Bonus Lab: Glue DataBrew" class="dd-item 
        
        
        
        ">
      <a href="/7-bonuslabgluedatabrew/">
          <b>7. </b>Bonus Lab: Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/7-bonuslabgluedatabrew/7.1-databrewpre-lab/" title="DataBrew Pre-Lab" class="dd-item 
        
        
        
        ">
      <a href="/7-bonuslabgluedatabrew/7.1-databrewpre-lab/">
           <b> 7.1 </b> DataBrew Pre-Lab
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/7-bonuslabgluedatabrew/7.2-datapreparationwithgluedatabrew/" title="Data preparation with Glue DataBrew" class="dd-item 
        
        
        
        ">
      <a href="/7-bonuslabgluedatabrew/7.2-datapreparationwithgluedatabrew/">
           <b> 7.2 </b> Data preparation with Glue DataBrew
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/8-clean/" title="Clean up" class="dd-item 
        
        
        
        ">
      <a href="/8-clean/">
          <b>8. </b>Clean up
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/660548818043427/"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/6-labdatalakeautomation/6.2-lakeformationlabforapachehuditables/" selected>English</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>23-04-2024</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
            <i> <a href="https://www.linkedin.com/in/nguy%E1%BB%85n-xu%C3%A2n-d%C6%B0%C6%A1ng-132936285/"  style="color:orange">Dương Nguyễn Xuân  </a> <br>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Data Engineering Immersion Day</a> > <a href='/6-labdatalakeautomation/'>Lab: Data Lake Automation</a> > Lake Formation Lab for Apache Hudi Tables
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#bước-1-tạo-glue-job-và-hudi-tables">Bước 1: Tạo Glue job và HUDI tables</a>
      <ul>
        <li><a href="#bước-2-truy-vấn-hudi-table-bằng-athena">Bước 2: Truy vấn HUDI table bằng Athena</a></li>
        <li><a href="#bước-3-phân-quyền-truy-cập-trong-lake-formation">Bước 3: Phân quyền truy cập trong Lake Formation</a></li>
        <li><a href="#bước-4-gán-quyền-lake-formation-và-truy-vấn-dữ-liệ">Bước 4: Gán quyền Lake Formation và truy vấn dữ liệ.</a></li>
        <li><a href="#kết-luận">Kết luận</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lake Formation Lab for Apache Hudi Tables
            </h1>
          

        



	<h2 id="bước-1-tạo-glue-job-và-hudi-tables">Bước 1: Tạo Glue job và HUDI tables</h2>
<ol>
<li>Tại Glue console. Tạo glue job với: ** Spark script editor**, <strong>Create a new script with boilerplate code</strong>. Và nhấn <strong>Create</strong>
<img src="/WorkShopTwo/images/6.clean/28.png" alt="Clean"></li>
</ol>
<p><img src="/WorkShopTwo/images/6.clean/29.png" alt="Clean"></p>
<ol start="2">
<li>Gán đoạn code sau vào Glue script editor</li>
</ol>
<pre tabindex="0"><code>
import sys
import os
import json

from pyspark.context import SparkContext
from pyspark.sql.session import SparkSession
from pyspark.sql.functions import concat, col, lit, to_timestamp, dense_rank, desc
from pyspark.sql.window import Window
from pyspark.sql.types import StringType

from awsglue.utils import getResolvedOptions
from awsglue.context import GlueContext
from awsglue.job import Job
from awsglue.dynamicframe import DynamicFrame

import boto3
from botocore.exceptions import ClientError

args = getResolvedOptions(sys.argv, [&#39;JOB_NAME&#39;, &#39;RAWZONE_BUCKET&#39;, &#39;CURATED_BUCKET&#39;])

spark = SparkSession.builder.config(&#39;spark.serializer&#39;,&#39;org.apache.spark.serializer.KryoSerializer&#39;).config(&#39;spark.sql.hive.convertMetastoreParquet&#39;, &#39;false&#39;).getOrCreate()
glueContext = GlueContext(spark.sparkContext)
job = Job(glueContext)
job.init(args[&#39;JOB_NAME&#39;], args)
logger = glueContext.get_logger()

logger.info(&#39;Initialization.&#39;)
glueClient = boto3.client(&#39;glue&#39;)

logger.info(&#39;Fetching configuration.&#39;)
region = os.environ[&#39;AWS_DEFAULT_REGION&#39;]

rawBucketName = args[&#39;RAWZONE_BUCKET&#39;]
curatedBucketName = args[&#39;CURATED_BUCKET&#39;]

if rawBucketName == None or curatedBucketName == None:
    raise Exception(&#34;Please input the bucket names in job parameters. Refer: https://docs.aws.amazon.com/glue/latest/dg/aws-glue-api-crawler-pyspark-extensions-get-resolved-options.html&#34;)

rawS3TablePath = &#39;s3://&#39; + rawBucketName + &#39;/tickets/dms_sample/ticket_purchase_hist/&#39;
cdcRawS3TablePath = &#39;s3://&#39; + rawBucketName + &#39;/cdc/dms_sample/ticket_purchase_hist/&#39;
curatedS3TablePathPrefix = &#39;s3://&#39; + curatedBucketName + &#39;/hudi/&#39;

sourceDBName = &#39;dms_sample&#39;
sourceTableName = &#39;ticket_purchase_hist&#39;

targetDBName = &#39;hudi_sample&#39;
targetTableName = &#39;ticket_purchase_hist&#39;

hudiStorageType = &#39;CoW&#39;

dropColumnList = [&#39;db&#39;,&#39;table_name&#39;,&#39;Op&#39;]
      
logger.info(&#39;Processing starts.&#39;)

keys = {
    &#34;dms_sample.ticket_purchase_hist&#34;: {&#34;primaryKey&#34;: &#34;sporting_event_ticket_id&#34;}
    }

spark.sql(&#39;CREATE DATABASE IF NOT EXISTS &#39; + targetDBName)

isTableExists = False
isPrimaryKey = False
isPartitionKey = False
primaryKey = &#39;&#39;
partitionKey = &#39;&#39;
try:
    glueClient.get_table(DatabaseName=targetDBName,Name=targetTableName)
    isTableExists = True
    logger.info(targetDBName + &#39;.&#39; + targetTableName + &#39; exists.&#39;)
except ClientError as e:
    if e.response[&#39;Error&#39;][&#39;Code&#39;] == &#39;EntityNotFoundException&#39;:
        isTableExists = False
        logger.info(targetDBName + &#39;.&#39; + targetTableName + &#39; does not exist. Table will be created.&#39;)

# lookup primary key and partition keys from keys json declared above
try:
    keyName = sourceDBName +&#34;.&#34; + sourceTableName
    logger.info(keyName)
    table_config = &#39;&#39;
    
    for key in keys:
        if key == keyName:
            table_config = keys[key]
    
    try:
        primaryKey = table_config[&#39;primaryKey&#39;]
        isPrimaryKey = True
        logger.info(&#39;Primary key:&#39; + primaryKey)
    except KeyError as e:
        isPrimaryKey = False
        logger.info(&#39;Primary key not found. An append only glueparquet table will be created.&#39;)
    try:
        partitionKey = table_config[&#39;partitionKey&#39;]
        isPartitionKey = True
        logger.info(&#39;Partition key:&#39; + partitionKey)
    except KeyError as e:
        isPartitionKey = False
        logger.info(&#39;Partition key not found. Partitions will not be created.&#39;)
except ClientError as e:    
    if e.response[&#39;Error&#39;][&#39;Code&#39;] == &#39;ParameterNotFound&#39;:
        isPrimaryKey = False
        isPartitionKey = False
        logger.info(&#39;Config for &#39; + sourceDBName + &#39;.&#39; + sourceTableName + &#39; not found in parameter store. Non partitioned append only table will be created.&#39;)

# Reads the raw zone table and writes to HUDI table
try:
    inputDyf = glueContext.create_dynamic_frame_from_options(connection_type = &#39;s3&#39;, connection_options = {&#39;paths&#39;: [rawS3TablePath], &#39;groupFiles&#39;: &#39;none&#39;, &#39;recurse&#39;:True}, format = &#39;csv&#39;, format_options={&#39;withHeader&#39;:True}, transformation_ctx = targetTableName)
    
    # Ensure timestamp is in HUDI timestamp format
    inputDf = inputDyf.toDF().withColumn(&#39;transaction_date_time&#39;, to_timestamp(col(&#39;transaction_date_time&#39;))).withColumn(primaryKey, col(primaryKey).cast(StringType()))
    inputDf = inputDf.withColumn(&#34;purchase_price&#34;,col(&#34;purchase_price&#34;).cast(&#39;double&#39;))

    logger.info(&#39;Total record count in raw table = &#39; + str(inputDyf.count()))

    targetPath = curatedS3TablePathPrefix + &#39;/&#39; + targetDBName + &#39;/&#39; + targetTableName

    morConfig = {
        &#39;hoodie.datasource.write.table.type&#39;: &#39;MERGE_ON_READ&#39;, 
        &#39;hoodie.compact.inline&#39;: &#39;false&#39;, 
        &#39;hoodie.compact.inline.max.delta.commits&#39;: 20, 
        &#39;hoodie.parquet.small.file.limit&#39;: 0
    }

    commonConfig = {
        &#39;className&#39; : &#39;org.apache.hudi&#39;, 
        &#39;hoodie.datasource.hive_sync.use_jdbc&#39;:&#39;false&#39;, 
        &#39;hoodie.datasource.write.precombine.field&#39;: &#39;transaction_date_time&#39;, 
        &#39;hoodie.datasource.write.recordkey.field&#39;: primaryKey, 
        &#39;hoodie.table.name&#39;: targetTableName, 
        &#39;hoodie.datasource.hive_sync.database&#39;: targetDBName, 
        &#39;hoodie.datasource.hive_sync.table&#39;: targetTableName, 
        &#39;hoodie.datasource.hive_sync.enable&#39;: &#39;true&#39;
    }

    partitionDataConfig = {
        &#39;hoodie.datasource.write.partitionpath.field&#39;: partitionKey, 
        &#39;hoodie.datasource.hive_sync.partition_extractor_class&#39;: &#39;org.apache.hudi.hive.MultiPartKeysValueExtractor&#39;, 
        &#39;hoodie.datasource.hive_sync.partition_fields&#39;: partitionKey
    }
                    
    unpartitionDataConfig = {
        &#39;hoodie.datasource.hive_sync.partition_extractor_class&#39;: &#39;org.apache.hudi.hive.NonPartitionedExtractor&#39;, 
        &#39;hoodie.datasource.write.keygenerator.class&#39;: &#39;org.apache.hudi.keygen.NonpartitionedKeyGenerator&#39;
    }
    
    incrementalConfig = {
        &#39;hoodie.upsert.shuffle.parallelism&#39;: 20, 
        &#39;hoodie.datasource.write.operation&#39;: &#39;upsert&#39;, 
        &#39;hoodie.cleaner.policy&#39;: &#39;KEEP_LATEST_COMMITS&#39;, 
        &#39;hoodie.cleaner.commits.retained&#39;: 10
    }
    
    initLoadConfig = {
        &#39;hoodie.bulkinsert.shuffle.parallelism&#39;: 100, 
        &#39;hoodie.datasource.write.operation&#39;: &#39;bulk_insert&#39;
    }
    
    deleteDataConfig = {
        &#39;hoodie.datasource.write.payload.class&#39;: &#39;org.apache.hudi.common.model.EmptyHoodieRecordPayload&#39;
    }

    if(hudiStorageType == &#39;MoR&#39;):
        commonConfig = {**commonConfig, **morConfig}
        logger.info(&#39;MoR config appended to commonConfig.&#39;)
    
    combinedConf = {}

    # HUDI require us to provide a primaryKey. If no primaryKey defined, we will fallback to &#39;glueparquet&#39; format
    if(isPrimaryKey):
        logger.info(&#39;Going the Hudi way.&#39;)
        if(isTableExists):
            logger.info(&#39;Incremental load.&#39;)
            inputDyf = glueContext.create_dynamic_frame_from_options(connection_type = &#39;s3&#39;, connection_options = {&#39;paths&#39;: [cdcRawS3TablePath], &#39;groupFiles&#39;: &#39;none&#39;, &#39;recurse&#39;:True}, format = &#39;csv&#39;, format_options={&#39;withHeader&#39;:True}, transformation_ctx = targetTableName)
            
            # Ensure timestamp is in HUDI timestamp format
            inputDf = inputDyf.toDF().withColumn(&#39;transaction_date_time&#39;, to_timestamp(col(&#39;transaction_date_time&#39;))).withColumn(primaryKey, col(primaryKey).cast(StringType()))
            inputDf = inputDf.withColumn(&#34;purchase_price&#34;,col(&#34;purchase_price&#34;).cast(&#39;double&#39;))

            # ensure only latest updates are kept for each record using descending timestamp order
            w = Window.partitionBy(primaryKey).orderBy(desc(&#39;transaction_date_time&#39;))
            inputDf = inputDf.withColumn(&#39;Rank&#39;,dense_rank().over(w))
            inputDf = inputDf.filter(inputDf.Rank == 1).drop(inputDf.Rank)

            outputDf = inputDf.filter(&#34;Op != &#39;D&#39;&#34;).drop(*dropColumnList)

            if outputDf.count() &gt; 0:
                logger.info(&#39;Upserting data. Updated row count = &#39; + str(outputDf.count()))
                if (isPartitionKey):
                    logger.info(&#39;Writing to partitioned Hudi table.&#39;)
                    outputDf = outputDf.withColumn(partitionKey,concat(lit(partitionKey+&#39;=&#39;),col(partitionKey)))
                    combinedConf = {**commonConfig, **partitionDataConfig, **incrementalConfig}
                    outputDf.write.format(&#39;hudi&#39;).options(**combinedConf).mode(&#39;Append&#39;).save(targetPath)
                else:
                    logger.info(&#39;Writing to unpartitioned Hudi table.&#39;)
                    combinedConf = {**commonConfig, **unpartitionDataConfig, **incrementalConfig}
                    outputDf.write.format(&#39;hudi&#39;).options(**combinedConf).mode(&#39;Append&#39;).save(targetPath)
            
            outputDf_deleted = inputDf.filter(&#34;Op = &#39;D&#39;&#34;).drop(*dropColumnList)

            if outputDf_deleted.count() &gt; 0:
                logger.info(&#39;Some data got deleted.&#39;)
                if (isPartitionKey):
                    logger.info(&#39;Deleting from partitioned Hudi table.&#39;)
                    outputDf_deleted = outputDf_deleted.withColumn(partitionKey,concat(lit(partitionKey+&#39;=&#39;),col(partitionKey)))
                    combinedConf = {**commonConfig, **partitionDataConfig, **incrementalConfig, **deleteDataConfig}
                    outputDf_deleted.write.format(&#39;hudi&#39;).options(**combinedConf).mode(&#39;Append&#39;).save(targetPath)
                else:
                    logger.info(&#39;Deleting from unpartitioned Hudi table.&#39;)
                    combinedConf = {**commonConfig, **unpartitionDataConfig, **incrementalConfig, **deleteDataConfig}
                    outputDf_deleted.write.format(&#39;hudi&#39;).options(**combinedConf).mode(&#39;Append&#39;).save(targetPath)
        else:
            outputDf = inputDf.drop(*dropColumnList)
            if outputDf.count() &gt; 0:
                logger.info(&#39;Inital load.&#39;)
                if (isPartitionKey):
                    logger.info(&#39;Writing to partitioned Hudi table.&#39;)
                    outputDf = outputDf.withColumn(partitionKey,concat(lit(partitionKey+&#39;=&#39;),col(partitionKey)))
                    combinedConf = {**commonConfig, **partitionDataConfig, **initLoadConfig}
                    outputDf.write.format(&#39;hudi&#39;).options(**combinedConf).mode(&#39;Overwrite&#39;).save(targetPath)
                else:
                    logger.info(&#39;Writing to unpartitioned Hudi table.&#39;)
                    combinedConf = {**commonConfig, **unpartitionDataConfig, **initLoadConfig}
                    outputDf.write.format(&#39;hudi&#39;).options(**combinedConf).mode(&#39;Overwrite&#39;).save(targetPath)
    else:
        if (isPartitionKey):
            logger.info(&#39;Writing to partitioned glueparquet table.&#39;)
            sink = glueContext.getSink(connection_type = &#39;s3&#39;, path= targetPath, enableUpdateCatalog = True, updateBehavior = &#39;UPDATE_IN_DATABASE&#39;, partitionKeys=[partitionKey])
        else:
            logger.info(&#39;Writing to unpartitioned glueparquet table.&#39;)
            sink = glueContext.getSink(connection_type = &#39;s3&#39;, path= targetPath, enableUpdateCatalog = True, updateBehavior = &#39;UPDATE_IN_DATABASE&#39;)
        sink.setFormat(&#39;glueparquet&#39;)
        sink.setCatalogInfo(catalogDatabase = targetDBName, catalogTableName = targetTableName)
        outputDyf = DynamicFrame.fromDF(inputDf.drop(*dropColumnList), glueContext, &#39;outputDyf&#39;)
        sink.writeFrame(outputDyf)
except BaseException as e:
    logger.info(&#39;An error occurred while processing table &#39; + targetDBName + &#39;.&#39; + targetTableName + &#39;. Please check the error logs...&#39;)
    print(e)

job.commit()
</code></pre><ol start="3">
<li>Nhập các thông số sau đây:</li>
</ol>
<ul>
<li>Name: glue-hudi-lf-job</li>
<li>Type: Spark</li>
<li>Glue version: Glue 3.0 - Supports spark 3.1, Scala 2, Python 3</li>
<li>Language: Python 3</li>
<li>Disable Job bookmark</li>
<li>Các thông số còn lại để default</li>
</ul>
<ol start="4">
<li>Nhập Job parameters</li>
</ol>
<ul>
<li>Key: &ndash;enable-glue-datacatalog, Value: true</li>
<li>Key: &ndash;CURATED_BUCKET , Value: Enter the bucket name from s3-target-endpoint to save the HUDI tables.</li>
<li>Key: &ndash;RAWZONE_BUCKET , Value: Enter the Bucket name from s3-target-endpoint.</li>
<li>Key: &ndash;datalake-formats , Value: hudi</li>
</ul>
<ol start="5">
<li>Lưu lại và click Run, đợi đến khi trạng thái Run là Succeeded</li>
</ol>
<p><img src="/WorkShopTwo/images/6.clean/31.png" alt="Clean"></p>
<h3 id="bước-2-truy-vấn-hudi-table-bằng-athena">Bước 2: Truy vấn HUDI table bằng Athena</h3>
<ol>
<li>Truy cập Athena, Chọn hudi_sample database và chạy thử truy vấn như sau:
<img src="/WorkShopTwo/images/6.clean/32.png" alt="Clean"></li>
</ol>
<h3 id="bước-3-phân-quyền-truy-cập-trong-lake-formation">Bước 3: Phân quyền truy cập trong Lake Formation</h3>
<ol>
<li>Tạo Iam Policy như sau:</li>
</ol>
<pre tabindex="0"><code>{
  &#34;Version&#34;: &#34;2012-10-17&#34;,
  &#34;Statement&#34;: [
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;athena:*&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;glue:CreateDatabase&#34;,
         &#34;glue:DeleteDatabase&#34;,
         &#34;glue:GetDatabase&#34;,
         &#34;glue:GetDatabases&#34;,
         &#34;glue:UpdateDatabase&#34;,
         &#34;glue:CreateTable&#34;,
         &#34;glue:DeleteTable&#34;,
         &#34;glue:BatchDeleteTable&#34;,
         &#34;glue:UpdateTable&#34;,
         &#34;glue:GetTable&#34;,
         &#34;glue:GetTables&#34;,
         &#34;glue:BatchCreatePartition&#34;,
         &#34;glue:CreatePartition&#34;,
         &#34;glue:DeletePartition&#34;,
         &#34;glue:BatchDeletePartition&#34;,
         &#34;glue:UpdatePartition&#34;,
         &#34;glue:GetPartition&#34;,
         &#34;glue:GetPartitions&#34;,
         &#34;glue:BatchGetPartition&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;s3:GetBucketLocation&#34;,
         &#34;s3:GetObject&#34;,
         &#34;s3:ListBucket&#34;,
         &#34;s3:ListBucketMultipartUploads&#34;,
         &#34;s3:ListMultipartUploadParts&#34;,
         &#34;s3:AbortMultipartUpload&#34;,
         &#34;s3:CreateBucket&#34;,
         &#34;s3:PutObject&#34;,
         &#34;s3:PutBucketPublicAccessBlock&#34;
       ],
       &#34;Resource&#34;: [
         &#34;arn:aws:s3:::aws-athena-query-results-*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;s3:GetObject&#34;,
         &#34;s3:ListBucket&#34;
       ],
       &#34;Resource&#34;: [
         &#34;arn:aws:s3:::athena-examples*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;s3:ListBucket&#34;,
         &#34;s3:GetBucketLocation&#34;,
         &#34;s3:ListAllMyBuckets&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;sns:ListTopics&#34;,
         &#34;sns:GetTopicAttributes&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;cloudwatch:PutMetricAlarm&#34;,
         &#34;cloudwatch:DescribeAlarms&#34;,
         &#34;cloudwatch:DeleteAlarms&#34;,
         &#34;cloudwatch:GetMetricData&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;lakeformation:GetDataAccess&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Effect&#34;: &#34;Allow&#34;,
       &#34;Action&#34;: [
         &#34;pricing:GetProducts&#34;
       ],
       &#34;Resource&#34;: [
         &#34;*&#34;
       ]
     },
     {
       &#34;Action&#34;: [
         &#34;s3:Put*&#34;,
         &#34;s3:Get*&#34;,
         &#34;s3:List*&#34;
       ],
       &#34;Resource&#34;: [
         &#34;arn:aws:s3:::dmslab-*/*&#34;
       ],
       &#34;Effect&#34;: &#34;Allow&#34;
     },
     {
       &#34;Action&#34;: [
         &#34;lakeformation:StartQueryPlanning&#34;,
         &#34;lakeformation:GetQueryState&#34;,
         &#34;lakeformation:GetWorkUnits&#34;,
         &#34;lakeformation:GetWorkUnitResults&#34;
       ],
       &#34;Resource&#34;: &#34;*&#34;,
       &#34;Effect&#34;: &#34;Allow&#34;
     }
  ]
}
</code></pre><ol start="2">
<li>Tạo 3 IAM user: lf-developer, lf-business_analyst, lf-campaign_manager,  lf-ml_user. gán policy vừa tạo ở bước 1 vào và cấp quyền truy cập console.</li>
</ol>
<h3 id="bước-4-gán-quyền-lake-formation-và-truy-vấn-dữ-liệ">Bước 4: Gán quyền Lake Formation và truy vấn dữ liệ.</h3>
<ol>
<li>Tại Lake Forrmation console, chọn Data lake permissions section</li>
<li>Nhấn Grant</li>
</ol>
<ul>
<li>Với user: lf-developer (Table-based Permissions)
<img src="/WorkShopTwo/images/6.clean/33.png" alt="Clean">
<img src="/WorkShopTwo/images/6.clean/34.png" alt="Clean"></li>
<li>Với user: business_analyst (Column-based Permissions)
<img src="/WorkShopTwo/images/6.clean/35.png" alt="Clean"></li>
</ul>
<p><img src="/WorkShopTwo/images/6.clean/36.png" alt="Clean"></p>
<ul>
<li>Với user: business_analyst (Cell level access
)
<img src="/WorkShopTwo/images/6.clean/35.png" alt="Clean"></li>
</ul>
<p><img src="/WorkShopTwo/images/6.clean/36.png" alt="Clean"></p>
<ul>
<li>Với campaign_manager:
<ul>
<li>
<p>Tạo Data filters:
<img src="/WorkShopTwo/images/6.clean/37.png" alt="Clean">
<img src="/WorkShopTwo/images/6.clean/38.png" alt="Clean"></p>
</li>
<li>
<p>Data permissions cho user: campaign_manager</p>
</li>
</ul>
</li>
</ul>
<p><img src="/WorkShopTwo/images/6.clean/39.png" alt="Clean"></p>
<ol start="3">
<li>Login vào từng user sử dụng Athena truy vấn để xác minh các quyền.</li>
</ol>
<h3 id="kết-luận">Kết luận</h3>
<p>Trong bài lab này, chúng ta đã tạo:</p>
<ol>
<li>Glue job để tạo HUDI table tương ứng từ source tables: ticket_purchase_hist</li>
<li>Áp dụng quyền vào Hudi Tables từ Lake Formation</li>
<li>Truy vấn với các quyền bằng Athena</li>
</ol>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/6-labdatalakeautomation/6.1-lakeformationlab/" title="Lake Formation Lab"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/6-labdatalakeautomation/6.3-lakeformationlabforapacheicebergtables/" title="Lake Formation Lab for Apache Iceberg Tables" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1715586281"></script>
    <script src="/js/perfect-scrollbar.min.js?1715586281"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1715586281"></script>
    <script src="/js/jquery.sticky.js?1715586281"></script>
    <script src="/js/featherlight.min.js?1715586281"></script>
    <script src="/js/highlight.pack.js?1715586281"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1715586281"></script>
    <script src="/js/learn.js?1715586281"></script>
    <script src="/js/hugo-learn.js?1715586281"></script>

    <link href="/mermaid/mermaid.css?1715586281" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1715586281"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
